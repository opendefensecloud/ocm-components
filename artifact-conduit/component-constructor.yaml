components:
  - name: opendefense.cloud/arc
    provider:
      name: opendefense.cloud
    labels:
      - name: app.kubernetes.io/name
        value: artifact-conduit
      - name: app.kubernetes.io/component
        value: artifact-gateway
      - name: app.kubernetes.io/part-of
        value: artifact-conduit
    resources:
      # ResourceGraphDefinition for KRO bootstrapping
      - name: artifact-conduit-rgd
        type: yaml
        relation: local
        input:
          type: file
          path: rgd-template.yaml

      # Artifact Conduit (ARC) Helm Chart (official)
      - name: arc-chart
        type: helmChart
        version: v0.1.4
        relation: external
        access:
          type: ociArtifact
          imageReference: ghcr.io/opendefensecloud/charts/arc:v0.2.1

      # API Server Container Image
      - name: arc-apiserver-image
        type: ociImage
        version: v0.2.0
        relation: external
        access:
          type: ociArtifact
          imageReference: ghcr.io/opendefensecloud/arc-apiserver:v0.2.1

      # Controller Manager Container Image
      - name: arc-controller-manager-image
        type: ociImage
        version: v0.2.0
        relation: external
        access:
          type: ociArtifact
          imageReference: ghcr.io/opendefensecloud/arc-controller-manager:v0.2.1

      # etcd Container Image
      - name: etcd-image
        type: ociImage
        version: v3.6.6
        relation: external
        access:
          type: ociArtifact
          imageReference: quay.io/coreos/etcd:v3.6.8

      # Minimal Configuration (Single instance, development)
      - name: arc-minimal-config
        type: yaml
        relation: local
        input:
          type: file
          path: minimal-values.yaml

      # Production Configuration (HA with replicas)
      - name: arc-production-config
        type: yaml
        relation: local
        input:
          type: file
          path: production-values.yaml

    # TODO: add sources back, there were some issues in CI (probably some issues in YAML):
    # Error: opendefense.cloud/arc:v26.1-rc.1: transferring source 0: failed to validate commit: commit is not a SHA
    # Error: component transport: opendefense.cloud/arc:v26.1-rc.1: transferring source 0: failed to validate commit: commit is not a SHA
    # sources:
    #   - name: arc-source
    #     type: git
    #     version: v0.2.0
    #     access:
    #       type: github
    #       repoUrl: github.com/opendefensecloud/artifact-conduit
    #       ref: v0.2.0
